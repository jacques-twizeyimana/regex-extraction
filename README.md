# Regex Data Extraction & Secure Validation Tool

Welcome to my data extraction tool. It extracts structured data (like emails and credit cards) from raw text and look for malicious input.

## Running the Tool

The easiest way to see it in action is to run it against the included sample data:

```bash
# Process the sample input file
python3 regex_extractor.py sample_input.txt
```

This will print a readable report to your console and save a detailed JSON file (`sample_output.json`) with the results.

## What It Extracts

I've designed regex patterns to identify and extract these six specific data types:

| Data Type        | Example Matches                                       |
| ---------------- | ----------------------------------------------------- |
| **Emails**       | `jane.doe@company.com`, `contact+sales@site.org`      |
| **URLs**         | `https://www.google.com`, `http://localhost:8080/api` |
| **Phones**       | `(555) 123-4567`, `+1 555-0199`, `123.456.7890`       |
| **Credit Cards** | `1234 5678 9012 3456`, `1234-5678-9012-3456`          |
| **HTML Tags**    | `<div class="main">`, `<img src="logo.png" />`        |
| **Hashtags**     | `#Python`, `#coding_is_fun`                           |

## Security Features

This isn't just a simple extraction script. Input from external sources is rarely trustworthy, so I've engineered this tool with several defensive layers:

### 1. Sensitive Data Masking

To prevent accidental exposure in logs or console output, sensitive data is partially hidden.

- **Credit Cards:** Automatically masked, showing only the last 4 digits (e.g., `**** **** **** 1234`).
- **Emails:** The username is partially hidden (e.g., `jan***@example.com`).

### 2. Threat Detection

The tool scans for patterns that indicate common attacks.

- **SQL Injection:** Detects attempts like `OR 1=1`, `UNION SELECT`, or `DROP TABLE`.
- **XSS (Cross-Site Scripting):** Blocks `<script>` tags, `javascript:` URIs, and dangerous event handlers like `onload`.

### 3. Safe Output

Extracted text is sanitized when printed to the console. Special HTML characters are escaped so that a malicious string like `<script>alert(1)</script>` is rendered as literal text rather than being executed as code.

## Under the Hood: Regex Implementation

Below are the regex patterns used for extraction, balanced for flexibility and security.

### Email Address

- **Regex**: `\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}\b`
- **Logic**: Matches the standard `user@domain.tld` structure. It ensures the top-level domain is at least two letters long and allows common symbols in the local part like dots, pluses, and underscores.

### Secure URLs

- **Regex**: `\bhttps?://(?:www\.)?[a-zA-Z0-9][-a-zA-Z0-9]*(?:\.[a-zA-Z0-9][-a-zA-Z0-9]*)*(?:\.[a-zA-Z]{2,})?(?::\d{1,5})?(?:/[^\s<>"']*)?`
- **Logic**: Strictly allows only `http` and `https` protocols to prevent protocol-based attacks (like `javascript:` or `file://`). It handles optional subdomains, ports, and complex paths.

### Credit Card Numbers

- **Regex**: `\b(?:\d{4}[\s-]?){3}\d{4}\b`
- **Logic**: Identifies 16-digit sequences grouped in fours. It accepts spaces or hyphens as separators, which are standard in manual entry.

### Phone Numbers

- **Regex**: `(?:\+1[\s.-]?)?\(?[0-9]{3}\)?[\s.-]?[0-9]{3}[\s.-]?[0-9]{4}\b`
- **Logic**: Supports multiple US formats including area codes in parentheses, dot/dash/space separators, and the optional `+1` country code.

### HTML Tags

- **Regex**: `</?[a-zA-Z][a-zA-Z0-9]*(?:\s+[^>]*)?\s*/?>`
- **Logic**: Captures opening, closing, and self-closing tags. It allows for any number of attributes within the tag.

### Hashtags

- **Regex**: `#[a-zA-Z_][a-zA-Z0-9_]*\b`
- **Logic**: Matches words starting with `#`. It requires the first character after the hash to be a letter or underscore, preventing numeric-only tags (like #123) from being flagged.

## Project Structure

- `regex_extractor.py`: The main Python script containing extraction and security logic.
- `sample_input.txt`: A test file with mixed valid and malicious data.
- `sample_output.json`: The structured results generated by the tool.
- `assignment.txt`: The original requirements for this project.

## Author

**Jacques Twizeyimana**  
Junior Frontend Developer  
ALU Data Extraction & Secure Validation Assignment
